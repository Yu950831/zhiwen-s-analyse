if (average%%5==1) {
TPP1_5$coverage_mean[average:average+4] <- sum(TPP1_5$coverage[average:average+4])/5
}
}
TPP1_5$coverage[1:4] <- 0
### in this section we select the proteins that exist the most times.As we delete
### one sample in TPP1 so we decide that if the protein appears more them 3 times
### we add it to an effective list.As for the others(USP7 and Blank),we set it to 4
### initial settings
install.packages("ggplot2")
library(tidyverse)
library(fs)
library(ggplot2)
library(readxl)
## now count the times of each the proteins that exist
sum_Tpp1 <- as.data.frame(table(TPP1_final$Accession)) %>%
filter(sum_Tpp1$Freq == 5)
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831')
for (proteins in sum_Tpp1$Var1[-1]) {
TPP1_5_R <- TPP1_final %>%
filter(TPP1_final$Accession == proteins)
TPP1_5 <- rbind(TPP1_5,TPP1_5_R)
}
## make the plot
names(TPP1_5) <- c('confidence','Accession','coverage','PSMs','sample','protein')
plot_TPP1 <- ggplot(data = TPP1_5,
mapping = aes(x=PSMs,
y=coverage,
col=sample,
xlab='PSMs',
ylab='coverage'))+geom_point()+
geom_text(aes(16,13.1578947,label='Q93009'))+
geom_text(aes(14,12.7051742,label='Q93009'))+
geom_text(aes(12,9.9096189,label='Q93009'))+
geom_text(aes(21,20.1451906,label='Q93009'))+
geom_text(aes(8,6.9872958,label='Q93009'))
plot_TPP1
install.packages("ggplot2")
sum_Tpp1 <- as.data.frame(table(TPP1_final$Accession)) %>%
filter(sum_Tpp1$Freq == 5)
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831')
for (proteins in sum_Tpp1$Var1[-1]) {
TPP1_5_R <- TPP1_final %>%
filter(TPP1_final$Accession == proteins)
TPP1_5 <- rbind(TPP1_5,TPP1_5_R)
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
TPP1_5$coverage_mean[average:average+4] <- sum(TPP1_5$coverage[average:average+4])/5
}
}
names(TPP1_5) <- c('confidence','Accession','coverage','PSMs','sample','protein')
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
TPP1_5$coverage_mean[average:average+4] <- sum(TPP1_5$coverage[average:average+4])/5
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mutate(TPP1_5$coverage_mean[average:average+4]=sum(TPP1_5$coverage[average:average+4])/5)
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mutate(TPP1_5$coverage_mean[average:average+4]=sum(TPP1_5$coverage[average:average+4])/5)
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
print(mean)
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
print(mean,average)
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
print(mean+str_c(average))
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
print(mean)
print(average)
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
TPP1_5 <- TPP1_5$coverage_mean[average,average+4] = mean
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
{mean <- sum(TPP1_5$coverage[average:average+4])/5}
TPP1_5 <- TPP1_5$coverage_mean[average,average+4] = mean
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
{mean <- sum(TPP1_5$coverage[average:average+4])/5}
TPP1_5$coverage_mean[average,average+4] = mean
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
{mean <- sum(TPP1_5$coverage[average:average+4])/5}
TPP5 <- TPP1_5 %>% mutate(coverage_mean[average,average+4] = mean)
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
{mean <- sum(TPP1_5$coverage[average:average+4])/5}
TPP5 <- TPP1_5 %>% mutate(coverage_mean[average,average+4] = mean)
}
}}
TPP1_5$coverage_mean = 1
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
TPP5 <- TPP1_5 %>% mutate(coverage_mean[average,average+4] = mean)
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
TPP5 <- TPP1_5 %>% mutate(coverage_mean[average,average+4],mean)
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
TPP5 <- TPP1_5 %>% mutate(coverage_mean[average:average+4],mean)
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
append(TPP1_5$coverage_mean,mean)
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
transform(TPP1_5$coverage_mean[average:average+4],mean)
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
transform(TPP1_5$coverage_mean[average:average+4],mean)
print(mean)
print(average)
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
mutate(coverage_mean[average:average+4] = mean)
print(mean)
print(average)
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
mutate(coverage_mean[average:average+4] , mean)
print(mean)
print(average)
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
mutate(TPP1_5,coverage_mean[average:average+4] = mean)
print(mean)
print(average)
}
}
coverage_mean <- list()
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
append(coverage_mean,mean)
}
}
coverage_mean
append(1:5, 0:1, after = 3)
coverage_mean <- list()
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
append(coverage_mean,mean,0)
}
}
coverage_mean
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
append(coverage_mean,mean,0)
}
}
coverage_mean
TPP1_5$coverage_mean[1:5] = mean
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
TPP1_5$coverage_mean[average:average+4] = mean
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
TPP1_5$coverage_mean[average:average+4] = mean
}
}
for (average in 1:nrow(TPP1_5)-4) {
if (average%%5==1) {
mean <- sum(TPP1_5$coverage[average:average+4])/5
TPP1_5$coverage_mean[average:average+4] = mean
print(mean)
}
}
View(sum_Tpp1)
View(sum_Tpp1)
View(sum_Tpp1)
sum_Tpp1 <- as.data.frame(table(TPP1_final$Accession)) %>%
filter(sum_Tpp1$Freq == 5)
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831')
for (proteins in sum_Tpp1$Var1[-1]) {
TPP1_5_R <- TPP1_final %>%
filter(TPP1_final$Accession == proteins)
TPP1_5 <- rbind(TPP1_5,TPP1_5_R)
}
## make the plot
names(TPP1_5) <- c('confidence','Accession','coverage','PSMs','sample','protein')
add_mean <- TPP1_5 %>% filter(TPP1_5$Accession='O95831')
add_mean
add_mean <- TPP1_5 %>% filter(TPP1_5$Accession=='O95831')
add_mean
test<- data.frame(x = c(1:10, 1:3), y=1:13)
test
test[!duplicated(test$x), ]
test[duplicated(test$x), ]
TPP1_5[!duplicated(TPP1_5$Accession)]
sum_Tpp1$Var1[-1]
View(TPP1_5)
View(TPP1_all)
View(TPP1_final)
TPP1_5[!duplicated(TPP1_5$Accession)]
sum_Tpp1 <- as.data.frame(table(TPP1_final$Accession)) %>%
filter(sum_Tpp1$Freq == 5)
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831')
for (proteins in sum_Tpp1$Var1[-1]) {
TPP1_5_R <- TPP1_final %>%
filter(TPP1_final$Accession == proteins)
TPP1_5 <- rbind(TPP1_5,TPP1_5_R)
}
sum_Tpp1 <- as.data.frame(table(TPP1_final$Accession)) %>%
filter(sum_Tpp1$Freq == 5)
### we found it is meaningless to compare the same proteins in different groups
### so we decide to make the different groups of each unique protein into one group
### and use them to do the clustering.
### initial settings
library(tidyverse)
library(fs)
library(ggplot2)
library(readxl)
### load the data
### as we supposed to editing the different kinds of the proteins and bind them
### so my solution is to load them respectively
## firstly we set the path of the 2 files to make it easier to read the files
savepleace <- 'analyse.R/'
path1 <- 'orgin.data/data/20220104'
path2 <- 'orgin.data/data/20220530'
## get all the file names in to list respectively
TPP1day1 <- list.files(path1,pattern = '^3FLAG-TPP1')
TPP1day2 <- list.files(path2,pattern = '^3FLAG-TPP1')
USP7day1 <- list.files(path1,pattern = '^3FLAG-USP7')
USP7day2 <- list.files(path1,pattern = '^3FLAG-USP7')
BLANkday1 <- list.files(path1,pattern = '^FLAGblank')
BLANkday2 <- list.files(path1,pattern = '^FLAGblank')
## editing the list to loop
dirTPP1a <- paste(path1,TPP1day1,sep = '/')
dirTPP1b <- paste(path2,TPP1day2,sep = '/')
dirUSP7a <- paste(path1,USP7day1,sep = '/')
dirUSP7b <- paste(path2,USP7day2,sep = '/')
dirBLANka <- paste(path1,BLANkday1,sep = '/')
dirBLANkb <- paste(path2,BLANkday1,sep = '/')
## set up the temp files to read the first of each protein files and make them
## as the samples to paste the rest of files after them
Temp1 <- read_xlsx(dirTPP1a[1]) %>%
mutate(sample = 'TPP1-1')
Temp2 <- read_xlsx(dirTPP1b[1]) %>%
mutate(sample='TPP1-4')
Temp3 <- read_xlsx(dirUSP7a[1]) %>%
mutate(sample='USP7-1',)
Temp4 <- read_xlsx(dirUSP7b[1]) %>%
mutate(sample='USP7-4')
Temp5 <- read_xlsx(dirBLANka[1]) %>%
mutate(sample='blank-1')
Temp6 <- read_xlsx(dirBLANkb[1]) %>%
mutate(sample='blank-4')
### now read all the TPP1 protein files and combine them into one file
for (filenames in 2:3) {
new.data <- read_xlsx(dirTPP1a[filenames]) %>%
mutate(sample=str_c('TPP1-',filenames))
Temp1 <- rbind(Temp1,new.data)
}
for (filenames in 2:2) {
new.data <- read_xlsx(dirTPP1b[filenames]) %>%
mutate(sample=str_c('TPP1-',filenames+3))
Temp2 <- rbind(Temp2,new.data)
}
TPP1_all <- rbind(Temp1,Temp2)
### next step to editing the USP7 files
for (filenames in 2:3) {
new.data <- read_xlsx(dirUSP7a[filenames]) %>%
mutate(sample=str_c('USP7-',filenames))
Temp3 <- rbind(Temp3,new.data)
}
for (filenames in 2:3) {
new.data <- read_xlsx(dirUSP7b[filenames]) %>%
mutate(sample=str_c('USP7-',filenames))
Temp4 <- rbind(Temp4,new.data)
}
USP7_all <- rbind(Temp3,Temp4)
### finally the blank samples
for (filenames in 2:3) {
new.data <- read_xlsx(dirBLANka[filenames]) %>%
mutate(sample=str_c('blank-',filenames))
Temp5 <- rbind(Temp5,new.data)
}
for (filenames in 2:3) {
new.data <- read_xlsx(dirBLANkb[filenames]) %>%
mutate(sample=str_c('blank-',filenames))
Temp6 <- rbind(Temp6,new.data)
}
Blank_all <- rbind(Temp5,Temp6)
## select the data we need and add some labels for the color of the later plot
## firstly the TPP1 data
TPP1_final <- TPP1_all %>%
select(1,2,5,7,13) %>%
mutate(protein= 'TPP1') %>%
filter(`Protein FDR Confidence` == 'High')
## then the USP7 data
USP7_final <- USP7_all %>%
select(1,2,5,7,13) %>%
mutate(protein = 'USP7') %>%
filter(`Protein FDR Confidence` == 'High')
## finally the BLANK samples
Blank_final <- Blank_all %>%
select(1,2,5,7,13) %>%
mutate(protein = 'Blank') %>%
filter(`Protein FDR Confidence` == 'High')
##Final_data <- rbind(TPP1_final,USP7_final)
##Final_data <- rbind(Final_data,Blank_final)
#save the data
write.table(TPP1_final,'TPP1_final')
write.table(USP7_final,'USP7_final')
write.table(Blank_final,'Blank_final')
## move the files to another folder
file.copy('TPP1_final','analyse.R/')
file.copy('USP7_final','analyse.R/')
file.copy('Blank_final','analyse.R/')
unlink('TPP1_final')
unlink('USP7_final')
unlink('Blank_final')
sum_Tpp1 <- as.data.frame(table(TPP1_final$Accession)) %>%
filter(sum_Tpp1$Freq == 5)
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831')
sum_Tpp1 <- as.data.frame(table(TPP1_final$Accession))
sum_Tpp1 <- as.data.frame(table(TPP1_final$Accession)) %>%
filter(sum_Tpp1$Freq == 5)
for (proteins in sum_Tpp1$Var1[-1]) {
TPP1_5_R <- TPP1_final %>%
filter(TPP1_final$Accession == proteins)
TPP1_5 <- rbind(TPP1_5,TPP1_5_R)
}
source("~/GitHub/zhiwen-s-analyse/operations/inner_group.R", echo=TRUE)
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831') %>%
mutate(coverage_mean=TPP1_5=sum(TPP1_5$Coverage)/5)
for (proteins in sum_Tpp1$Var1[-1]) {
TPP1_5_R <- TPP1_final %>%
filter(TPP1_final$Accession == proteins) %>%
mutate(coverage_mean=sum(TPP1_5_R$Coverage)/5)
TPP1_5 <- rbind(TPP1_5,TPP1_5_R)
}
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831') %>%
mutate(coverage_mean=TPP1_5=sum(TPP1_5$Coverage)/5)
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831') %>%
mutate(coverage_mean=TPP1_5=sum(TPP1_5$Coverage)/5)
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831') %>%
mutate(coverage_mean=TPP1_5==sum(TPP1_5$Coverage)/5)
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831') %>%
mutate(coverage_mean=TPP1_5=mean(TPP1_5$Coverage))
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831') %>%
mutate(coverage_mean=TPP1_5,mean(TPP1_5$Coverage))
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831')
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831') %>%
mutate(coverage_mean=TPP1_5,mean(TPP1_5$Coverage))
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831') %>%
mutate(coverage_mean=TPP1_5,mean(TPP1_5$Coverage))
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831')
mean(TPP1_5$Coverage)
mutate(TPP1_5,coverage_mean=mean)
mutate(TPP1_5,coverage_mean=mean(TPP1_5$Coverage))
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831') %>%
mutate(coverage_mean,mean(TPP1_5$Coverage))
add_mean <- as.data.frame(names(add_mean)=c('confidence','Accession','coverage','PSMs','sample','protein'))
add_mean <- as.data.frame(names(add_mean) <- c('confidence','Accession','coverage','PSMs','sample','protein'))
View(add_mean)
View(add_mean)
for (proteins in unique(sum_Tpp1$Var1)) {print(proteins)}
SD_calculate <- as.data.frame(confidence=c())
SD_calculate <- as.data.frame(confidence=c(''))
View(TPP1_all)
View(USP7_final)
## we got the data yesterday in (inner_group.R)
names(TPP1_final) <- c('confidence','Accession','coverage','PSMs','sample','protein')
View(TPP1_final)
View(TPP1_final)
sum(TPP1_final$coverage)/5
for (proteins in unique(sum_Tpp1$Var1)) {
TPP1_SD <- TPP1_final %>%
filter(TPP1_final$Accession=proteins) %>%
mutate(coverage_mean=sum(TPP1_final$coverage)/5) %>%
mutate(PSMs_mean=sum(TPP1_final)/5) %>%
mutate(distance_center= sqrt((TPP1_final$coverage-sum(TPP1_final$coverage)/5)^2
+(TPP1_final-sum(TPP1_final)/5)^2))
}
for (proteins in unique(sum_Tpp1$Var1)) {
TPP1_SD <- TPP1_final %>%
filter(TPP1_final$Accession=proteins) %>%
mutate(coverage_mean=sum(TPP1_final$coverage)/5)}
for (proteins in unique(sum_Tpp1$Var1)) {
TPP1_SD <- TPP1_final %>%
filter(TPP1_final$Accession=proteins) %>%
coverage_meanx=sum(TPP1_final$coverage)/5
mutate(coverage_mean=coverage_meanx)} %>%}
for (proteins in unique(sum_Tpp1$Var1)) {
TPP1_SD <- TPP1_final %>%
filter(TPP1_final$Accession=proteins) %>%
coverage_meanx=sum(TPP1_final$coverage)/5
mutate(coverage_mean=coverage_meanx)}
for (proteins in unique(sum_Tpp1$Var1)) {
TPP1_SD <- TPP1_final %>%
filter(TPP1_final$Accession=proteins)
print(TPP1_SD)}
for (proteins in unique(sum_Tpp1$Var1)) {
TPP1_SD <- TPP1_final %>%
filter(TPP1_final$Accession=proteins)}
print(TPP1_SD)
for (proteins in unique(sum_Tpp1$Var1)) {
TPP1_SD <- TPP1_final %>%
filter(TPP1_final$Accession=proteins)
print(TPP1_SD)
}
for (variable in TPP1_final$protein) {filter(TPP1_final$Accession='
Q96AP0') %>%
}
for (variable in TPP1_final$protein) {filter(TPP1_final$Accession='
Q96AP0') %>%
}
for (variable in TPP1_final$protein) {filter(TPP1_final$Accession='
Q96AP0')
}
for (proteins in sum_Tpp1$Var1[-1]) {
TPP1_5_R <- TPP1_final %>%
filter(TPP1_final$Accession == proteins) %>%
mutate(coverage_mean=sum(TPP1_5_R$Coverage)/5)
TPP1_5 <- rbind(TPP1_5,TPP1_5_R)
}
View(TPP1_5_R)
View(TPP1_5_R)
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831') %>%
mutate(coverage_mean,mean(TPP1_5$Coverage))
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831') %>%
mutate(coverage_mean,sum(TPP1_5$Coverage)/5)
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831') %>%
mutate(coverage_mean=sum(TPP1_5$Coverage)/5)
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831') %>%
mutate(coverage_mean=sum(TPP1_5$Coverage)/5)
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831') %>%
mutate(coverage_mean=sum(TPP1_5$coverage)/5)
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831') %>%
mutate(coverage_mean=sum(TPP1_5$coverage)/5)
for (proteins in sum_Tpp1$Var1[-1]) {
TPP1_5_R <- TPP1_final %>%
filter(TPP1_final$Accession == proteins) %>%
mutate(coverage_mean=sum(TPP1_5_R$Coverage)/5)
TPP1_5 <- rbind(TPP1_5,TPP1_5_R)
TPP1_5 <- TPP1_final %>% filter(TPP1_final$Accession =='O95831') %>%
mutate(coverage_mean=sum(TPP1_5$coverage)/5)
for (proteins in sum_Tpp1$Var1[-1]) {
TPP1_5_R <- TPP1_final %>%
filter(TPP1_final$Accession == proteins) %>%
mutate(coverage_mean=sum(TPP1_5_R$Coverage)/5)
TPP1_5 <- rbind(TPP1_5,TPP1_5_R)
}
for (proteins in sum_Tpp1$Var1[-1]) {
TPP1_5_R <- TPP1_final %>%
filter(TPP1_final$Accession == proteins) %>%
mutate(coverage_mean=sum(TPP1_5_R$Coverage)/5)
TPP1_5 <- rbind(TPP1_5,TPP1_5_R)
}
